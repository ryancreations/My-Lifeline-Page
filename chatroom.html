<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Our Messages</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  background:#f5f5f5;
  font-family:'Segoe UI',sans-serif;
  height:100vh;
  display:flex;
  flex-direction:column;
}
header{
  background:#ff6b9d;
  color:#fff;
  padding:20px;
  text-align:center;
  font-size:1.8em;
  font-weight:600;
}
#messages{
  flex:1;
  padding:20px;
  overflow-y:auto;
  background:#fff;
  display:flex;
  flex-direction:column;
  gap:12px;
}
.message{
  max-width:80%;
  padding:14px 20px;
  border-radius:20px;
  line-height:1.5;
}
.you{
  background:#ff9a9e;
  color:#fff;
  align-self:flex-end;
  border-bottom-right-radius:4px;
}
.them{
  background:#e0e0e0;
  color:#000;
  align-self:flex-start;
  border-bottom-left-radius:4px;
}
.time{
  font-size:.8em;
  color:#555;
  margin-top:6px;
  text-align:right;
}
#inputArea{
  background:#fff;
  border-top:1px solid #eee;
  padding:15px;
  display:flex;
  gap:10px;
  align-items:center;
}
#msg{
  flex:1;
  padding:16px;
  border-radius:30px;
  border:1px solid #ddd;
  font-size:1.1em;
}
#send{
  background:#ff6b9d;
  color:#fff;
  width:50px;
  height:50px;
  border-radius:50%;
  border:none;
  font-size:1.4em;
  cursor:pointer;
}
</style>
</head>

<body>

<header>Our Messages</header>

<div id="messages"></div>

<div id="inputArea">
  <input type="text" id="msg" placeholder="Type a message…">
  <button id="send">➤</button>
</div>

<!-- FIREBASE (DATABASE ONLY) -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>
/* FIREBASE — DATABASE ONLY */
firebase.initializeApp({
  databaseURL: "https://chatroom-3b44c-default-rtdb.firebaseio.com"
});

const db = firebase.database().ref("messages");

/* USER */
let name = localStorage.getItem("myName");
if(!name){
  name = prompt("What's your name?");
  localStorage.setItem("myName", name);
}

/* ELEMENTS */
const messages = document.getElementById("messages");
const msgInput = document.getElementById("msg");
const sendBtn = document.getElementById("send");

/* SEND */
function sendMessage(){
  const text = msgInput.value.trim();
  if(!text) return;

  db.push({
    name: name,
    text: text,
    time: Date.now()
  });

  msgInput.value = "";
}

/* RECEIVE */
db.limitToLast(100).on("child_added", snap => {
  const m = snap.val();
  const div = document.createElement("div");
  div.className = `message ${m.name === name ? "you" : "them"}`;
  div.textContent = m.text;

  const t = document.createElement("div");
  t.className = "time";
  t.textContent = new Date(m.time).toLocaleTimeString([], {
    hour:"numeric",
    minute:"2-digit"
  });

  div.appendChild(t);
  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
});

/* EVENTS */
sendBtn.onclick = sendMessage;
msgInput.addEventListener("keydown", e => {
  if(e.key === "Enter") sendMessage();
});
</script>

</body>
</html>