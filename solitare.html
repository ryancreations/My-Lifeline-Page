<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Solitaire • My Lifeline</title>
<style>
body {
  font-family: 'Quicksand', sans-serif;
  background: #0a0a1f;
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 10px;
  margin:0;
}
h1 { margin-bottom: 10px; text-align:center; }

#foundations {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 5px;
  margin-bottom: 10px;
}
.foundation {
  width: 60px;
  height: 80px;
  background: #1a1a2e;
  border-radius: 5px;
  position: relative;
}

#stock {
  width: 60px;
  height: 80px;
  background: #444;
  border-radius: 5px;
  margin-bottom: 10px;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
}

#board {
  display: grid;
  grid-template-columns: repeat(7, 60px);
  gap: 5px;
}

.pile {
  width: 60px;
  height: 400px;
  background: #1a1a2e;
  border-radius: 5px;
  position: relative;
}

.card {
  width: 60px;
  height: 80px;
  border-radius: 5px;
  background: white;
  color: black;
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  top: 0;
  left: 0;
  cursor: pointer;
  user-select: none;
  font-size: 0.7em;
}
.card.red { color: red; }
.card.face-down { background: #222; color: #222; }

.dragging { z-index: 1000; }
</style>
</head>
<body>

<h1>Solitaire</h1>

<div id="foundations">
  <div class="foundation" data-suit="♠"></div>
  <div class="foundation" data-suit="♥"></div>
  <div class="foundation" data-suit="♦"></div>
  <div class="foundation" data-suit="♣"></div>
</div>

<div id="stock" onclick="drawCard()">Stock</div>

<div id="board"></div>

<script>
const suits = ["♠","♥","♦","♣"];
let deck = [];
for(let s of suits){
  for(let i=1;i<=13;i++){
    deck.push({value:i, suit:s, color:(s==="♥"||s==="♦")?"red":"black"});
  }
}

function shuffle(array){for(let i=array.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[array[i],array[j]]=[array[j],array[i]];}}
shuffle(deck);

const board = document.getElementById('board');
const piles = [];
for(let i=0;i<7;i++){
  const pile = document.createElement('div');
  pile.classList.add('pile');
  board.appendChild(pile);
  piles.push(pile);
  for(let j=0;j<=i;j++){
    const cardData = deck.pop();
    const card = document.createElement('div');
    card.classList.add('card');
    card.textContent = cardData.value + cardData.suit;
    if(cardData.color==="red") card.classList.add('red');
    card.dataset.value = cardData.value;
    card.dataset.suit = cardData.suit;
    card.dataset.color = cardData.color;
    card.dataset.face = j<i ? "down" : "up";
    if(j<i) card.classList.add('face-down');
    card.style.top = `${j*15}px`;
    pile.appendChild(card);
    addDragEvents(card);
  }
}

// === Dragging ===
let dragged = null;
function addDragEvents(card){
  card.addEventListener('mousedown', dragStart);
  card.addEventListener('touchstart', dragStart);
}

function dragStart(e){
  e.preventDefault();
  dragged = e.target;
  if(dragged.dataset.face==="down") return;

  const move = (e)=>{
    let x = e.pageX || e.touches[0].pageX;
    let y = e.pageY || e.touches[0].pageY;
    dragged.style.transform = `translate(${x-30}px,${y-40}px)`;
  }

  const end = ()=>{
    dragged.style.transform = '';
    dragged = null;
    document.removeEventListener('mousemove',move);
    document.removeEventListener('touchmove',move);
    document.removeEventListener('mouseup',end);
    document.removeEventListener('touchend',end);
  }

  document.addEventListener('mousemove',move);
  document.addEventListener('touchmove',move);
  document.addEventListener('mouseup',end);
  document.addEventListener('touchend',end);
}

// === Stock Pile ===
function drawCard(){
  if(deck.length===0){ alert("No more cards in stock!"); return; }
  const cardData = deck.pop();
  const card = document.createElement('div');
  card.classList.add('card');
  card.textContent = cardData.value + cardData.suit;
  if(cardData.color==="red") card.classList.add('red');
  card.dataset.value = cardData.value;
  card.dataset.suit = cardData.suit;
  card.dataset.color = cardData.color;
  card.dataset.face="up";
  card.style.top="0px"; card.style.left="0px";
  document.body.appendChild(card);
  addDragEvents(card);
}
</script>

</body>
</html>