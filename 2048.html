<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2048 â€¢ My Lifeline</title>

<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@600&display=swap" rel="stylesheet">

<style>
body{
  background:#faf8ef;
  font-family:'Quicksand',sans-serif;
  display:flex;
  flex-direction:column;
  align-items:center;
  margin:0;
  padding-top:80px;
}

nav{
  position:fixed;
  top:0;
  width:100%;
  background:#87ceeb;
  padding:6px;
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:6px;
  z-index:10;
}

nav button{
  background:white;
  border:none;
  padding:6px 12px;
  border-radius:18px;
  font-weight:600;
  cursor:pointer;
}

header{
  width:320px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:15px;
}

h1{margin:0;color:#776e65}

.score-box{
  background:#bbada0;
  color:white;
  padding:10px 18px;
  border-radius:8px;
  font-size:1em;
}

#board{
  background:#bbada0;
  padding:12px;
  border-radius:12px;
  display:grid;
  grid-template-columns:repeat(4,70px);
  grid-gap:12px;
  touch-action:none;
}

.cell{
  width:70px;
  height:70px;
  background:#cdc1b4;
  border-radius:8px;
}

.tile{
  position:absolute;
  width:70px;
  height:70px;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.6em;
  font-weight:bold;
  transition:.18s ease-in-out;
}

.tile-2{background:#eee4da;color:#776e65}
.tile-4{background:#ede0c8;color:#776e65}
.tile-8{background:#f2b179;color:#fff}
.tile-16{background:#f59563;color:#fff}
.tile-32{background:#f67c5f;color:#fff}
.tile-64{background:#f65e3b;color:#fff}
.tile-128{background:#edcf72;color:#fff}
.tile-256{background:#edcc61;color:#fff}
.tile-512{background:#edc850;color:#fff}
.tile-1024{background:#edc53f;color:#fff}
.tile-2048{background:#edc22e;color:#fff}

button.restart{
  margin-top:20px;
  padding:12px 24px;
  border:none;
  border-radius:25px;
  background:#8f7a66;
  color:white;
  font-size:1.1em;
  cursor:pointer;
}
</style>
</head>

<body>

<nav>
  <button onclick="location.href='index.html'">Dashboard</button>
  <button onclick="location.href='mental.html'">Mental</button>
  <button onclick="location.href='reflect.html'">Reflect</button>
</nav>

<header>
  <h1>2048</h1>
  <div class="score-box">Score: <span id="score">0</span></div>
</header>

<div id="board"></div>

<button class="restart" onclick="init()">Restart</button>

<script>
const size = 4;
let board, score;

const boardEl = document.getElementById("board");
const scoreEl = document.getElementById("score");

function init(){
  board = Array.from({length:size},()=>Array(size).fill(0));
  score = 0;
  boardEl.innerHTML='';
  scoreEl.textContent = score;

  for(let i=0;i<16;i++){
    const cell = document.createElement("div");
    cell.className="cell";
    boardEl.appendChild(cell);
  }

  addTile(); addTile();
  draw();
}

function addTile(){
  let empty=[];
  board.forEach((r,i)=>r.forEach((v,j)=>v===0&&empty.push([i,j])));
  if(!empty.length) return;
  const [r,c]=empty[Math.floor(Math.random()*empty.length)];
  board[r][c]=Math.random()<0.9?2:4;
}

function draw(){
  document.querySelectorAll(".tile").forEach(t=>t.remove());
  board.forEach((row,r)=>{
    row.forEach((v,c)=>{
      if(v){
        const tile=document.createElement("div");
        tile.className=`tile tile-${v}`;
        tile.textContent=v;
        tile.style.transform=`translate(${c*82}px,${r*82}px)`;
        boardEl.appendChild(tile);
      }
    });
  });
  scoreEl.textContent=score;
}

function slide(row){
  row=row.filter(v=>v);
  for(let i=0;i<row.length-1;i++){
    if(row[i]===row[i+1]){
      row[i]*=2;
      score+=row[i];
      row[i+1]=0;
    }
  }
  row=row.filter(v=>v);
  while(row.length<size) row.push(0);
  return row;
}

function move(dir){
  let moved=false;

  const rotateLeft = m => m[0].map((_,i)=>m.map(r=>r[i])).reverse();
  const rotateRight = m => rotateLeft(rotateLeft(rotateLeft(m)));

  if(dir==="up") board=rotateLeft(board);
  if(dir==="down") board=rotateRight(board);
  if(dir==="right") board=board.map(r=>r.reverse());

  for(let r=0;r<size;r++){
    const newRow=slide(board[r]);
    if(newRow.some((v,i)=>v!==board[r][i])) moved=true;
    board[r]=newRow;
  }

  if(dir==="right") board=board.map(r=>r.reverse());
  if(dir==="up") board=rotateRight(board);
  if(dir==="down") board=rotateLeft(board);

  if(moved){ addTile(); draw(); }
}

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp") move("up");
  if(e.key==="ArrowDown") move("down");
  if(e.key==="ArrowLeft") move("left");
  if(e.key==="ArrowRight") move("right");
});

let sx,sy;
boardEl.addEventListener("touchstart",e=>{
  sx=e.touches[0].clientX;
  sy=e.touches[0].clientY;
});
boardEl.addEventListener("touchend",e=>{
  const dx=e.changedTouches[0].clientX-sx;
  const dy=e.changedTouches[0].clientY-sy;
  if(Math.abs(dx)>Math.abs(dy)){
    move(dx>0?"right":"left");
  }else{
    move(dy>0?"down":"up");
  }
});

init();
</script>

</body>
</html>